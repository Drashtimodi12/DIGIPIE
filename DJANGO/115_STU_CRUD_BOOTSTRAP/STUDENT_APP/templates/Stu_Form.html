{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Form</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" 
        rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" 
        crossorigin="anonymous">
</head>
<body>

<div class="container mt-4">

    <div class="row">
        <!-- ===== STUDENT FORM ===== -->
        <div class="col-4 card p-3">
            <h3><center>STUDENT REGISTRATION</center></h3>
            <hr>

            <form action="{% url 'register_students' %}" method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Hidden ID for update -->
                <input type="hidden" name="SID" value="{{ stu.id }}">

                <div class="mb-3">
                    <label><b>Student Name</b></label>
                    <input type="text" name="STU_NAME" class="form-control" placeholder="Enter Student Name" value="{{ stu.STU_NAME }}">
                </div>

                <div class="mb-3">
                    <label>Surname</label>
                    <input type="text" name="STU_SURENAME" class="form-control" placeholder="Enter Surname" value="{{ stu.STU_SURENAME }}">
                </div>

                <div class="mb-3">
                    <label>Birthdate</label>
                    <input type="date" name="STU_BIRTHDATE" class="form-control" value="{{ stu.STU_BIRTHDATE }}">
                </div>

                <div class="mb-3">
                    <label>Email</label>
                    <input type="email" name="EMAIL" class="form-control" placeholder="Enter Email address" value="{{ stu.EMAIL }}">
                </div>

                <div class="mb-3">
                    <label>Contact Number</label>
                    <input type="text" name="CONTACT_NUMBER" class="form-control" placeholder="Enter contact number" value="{{ stu.CONTACT_NUMBER }}">
                </div>

                <!-- Show Existing Photo -->
                {% if stu.STU_PHOTO %}
                    <div class="mb-2">
                        <img src="{{ stu.STU_PHOTO.url }}" width="100" height="100" class="rounded">
                        <p class="text-muted">{{ stu.STU_PHOTO.name }}</p>
                    </div>
                {% endif %}

                <div class="mb-3">
                    <label>Student Photo</label>
                    <input type="file" name="STU_PHOTO" class="form-control">
                </div>

                <button class="btn btn-success w-100">Submit</button>
            </form>
        </div>

        <div class="col-1"></div>

        <!-- ===== STUDENT TABLE ===== -->
        <div class="col-7 card p-3">
            <h3><center>All Students</center></h3>
            <hr>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Surname</th>
                        <th>Birthdate</th>
                        <th>Email</th>
                        <th>Contact</th>
                        <th>Photo</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody>
                {% for s in student %}
                    <tr>
                        <td>{{ s.id }}</td>
                        <td>{{ s.STU_NAME }}</td>
                        <td>{{ s.STU_SURENAME }}</td>
                        <td>{{ s.STU_BIRTHDATE }}</td>
                        <td>{{ s.EMAIL }}</td>
                        <td>{{ s.CONTACT_NUMBER }}</td>

                        <td>
                            {% if s.STU_PHOTO %}
                                <img src="media/{{ s.STU_PHOTO }}" alt="{{ s.STU_PHOTO }}" width="100" height="100">
                            {% else %}
                                No Image
                            {% endif %}
                        </td>

                        <td>
                            <a href="{% url 'update_students' %}?stu_id={{ s.id }}"
                               class="btn btn-warning btn-sm">Edit</a>

                            
                            <a href="{% url 'delete_students' %}?stu_id={{ s.id }}"
                                class="btn btn-danger btn-sm mt-1"
                                onclick="return confirmDelete();">Delete</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>

            </table>
        </div>
    </div>
</div>
    <script src="{% static 'js1/app.js' %}"></script>
</body>
</html>
